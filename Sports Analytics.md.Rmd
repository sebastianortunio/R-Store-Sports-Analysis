---
title: "Sports Store Analysis"
author: "Sebastian Ortuno"
date: "2025-06-13"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# **Sports Store project**
### **Author: Sebastian Ortuno**
### **Tools used: RStudio.**

------------------------------------------------------------------------------------------------------

## **Project Overview:**


- In this project, I use SQL to analyze and clean data from a fictional sports store. The goal is to answer key business questions and extract insights on revenue, profit,
customer ratings, and geographic trends.


-----------------------------------------------------------------------------------------------------
### **Libraries:**
Before we start with the business requirements, I load the libraries needed for this project.

```{r}
library(openxlsx)
library(tidyverse)
library(dplyr)
library(lubridate)
library(ggplot2)
```
## **Load and view the dataset**

```{r}
orders<-read.csv("C:/Users/sebas/OneDrive/Documents/NEC MASTERS/Projects Portfolio/Projects Portfolio/R Projects/Sports Analytics/Orders.csv")

customer<-read.csv("C:/Users/sebas/OneDrive/Documents/NEC MASTERS/Projects Portfolio/Projects Portfolio/R Projects/Sports Analytics/Customers.csv")

head(orders)
head(customer)

```
## **-- Data Cleaning and Business Requirements:**

### -- 1) Convert 'date' column (in text format) to a proper DATE type and store in 'Date_New'.
### -- 2) KPIs: total revenue, profit, number of orders, profit margin.
### -- 3) KPIs by sport: revenue, profit, orders, profit margin.
### -- 4) Customer ratings: number, the percentage of ratings the company got from all the orders, average rating.
### -- 5) Ratings distribution: number of orders by rating, revenue by rating, profit by rating, and profit margin by rating.
### -- 6) Revenue, profit, and profit margin by State.
### -- 7) Monthly profit trends and comparison with previous month.
### -- 8) Monthly profit trends and comparison with previous month.


### **1) Convert 'date' column (in text format) to a proper DATE type and store in 'Date_New'.**
```{r}
orders<-orders%>%mutate(New_date=as_date(date, format="%m/%d/%Y"))
orders<-orders%>%select("order_id","customer_id","sport","revenue","profit","shipping_cost",
                        "rating","New_date")
```
### **2) KPIs: total revenue, profit, number of orders, profit margin.**
```{r}
KPI<-orders%>%  # Start with the orders 
  summarize(Total_Revenue=sum(revenue,na.rm=TRUE),#Summarize revenue  
    Total_Profit=sum(profit),  # Summarize orders
    N_orders=n_distinct(order_id),# Count orders using summarize
    Profit_Margin=round((Total_Profit/Total_Revenue)*100,2)) #Profit Margin 

KPI
```
- Total Revenue: $459,418.40

The store generated nearly half a million in total sales — strong revenue.

- Total Profit: $284,821.90

Profit makes up a significant portion of revenue, indicating healthy operations.

- Number of Orders: 2,847

On average, each order generates about $161.35 in revenue
(459,418.4 ÷ 2,847)

- Profit Margin: 62%

Very high margin — over half of every dollar earned is profit, which is excellent for retail.

### **3) KPIs by sport: revenue, profit, orders, profit margin.**
```{r}
KPI_sports<-orders%>% # Start with the 'orders' dataset
  group_by(sport)%>% # Group data by 'sport' category
  summarise(Total_Revenue=sum(revenue), # Sum revenue for each sport
    Total_Profit=sum(profit),           # Sum profit for each sport
    Total_Orders=n_distinct(order_id),  # Count unique orders per sport
    Profit_Margin=round((Total_Profit/Total_Revenue)*100,2))%>%  # Calculate profit margin (%)
    arrange(desc(Total_Profit), desc(Total_Orders))  # Order results by highest profit, then orders
                      
KPI_sports


```


- All sports have profit margins above 60%, which is a strong indicator of overall profitability.

- Soccer has the highest margin, while Basketball has the highest order volume.

- Football and Baseball show excellent balance between high revenue and strong margins.

- Hockey, although slightly behind in margin, still performs well and could improve further with cost optimization.

### **4) Customer ratings: number, percentage of ratings from all orders, average rating.**
```{r}
# We need to work with NA values for rating column.

Customer_Ratings<-  # Start with the 'orders' dataset
    orders%>% # Start with the 'orders' dataset
    summarise(Average_Rating=round(mean(rating, na.rm=TRUE),2),  # Calculate average rating (ignore NAs), rounded to 2 decimals
    Total_Rating=sum(!is.na(rating)),# Count how many ratings are not missing
    Percentage_rating= round((Total_Rating/2847)*100,2)) # Calculate percent of orders with ratings (assuming 2847 total orders)




Customer_Ratings   # Display the summarized ratings info


```
### **5) Ratings distribution: number of orders by rating, revenue by rating, profit by rating, and profit margin by rating.**

```{r}
rating_distribution<-orders %>%  # Use orders data
  group_by(rating) %>% summarise(orders_by_ratings=n(),    # Group by rating value
    revenue_by_rating=sum(revenue),                        # Count orders per rating
    profit_by_rating=sum(profit),                          # Sum revenue per rating
  profit_margin=round((profit_by_rating/revenue_by_rating)*100,2))%>% # Profit margin % per rating
  arrange(desc(rating))                                    # Sort by rating descending
                                     
rating_distribution                                        # Show results
```

- Rating 3 shows the highest profit margin (62.62%) despite not having the most orders.  
- Rating 5 leads in revenue and profit, but with a lower margin (59.06%).  
- Lower ratings (1–2) have the lowest margins, indicating potential customer dissatisfaction.  
- No direct correlation between higher rating and better profitability.

### **6) Analyze revenue, profit, and profit margin by state.**
- 6.2) Best profiability efficiency (Top 3)
```{r}

inner_join(orders, customer, by="customer_id") %>% # Join orders with customer data by customer_id
  group_by(State) %>%                             # Group data by State
  summarise(Revenue_by_state= sum(revenue),       # Sum revenue per state
    profit_by_state = sum(profit),                # Sum profit per state
    profit_margin= round((profit_by_state/Revenue_by_state)*100,2)) %>%  # Calculate profit margin % per state
  mutate(rank_by_margin = as.integer(dense_rank(desc(profit_margin)))) %>%  # Rank states by descending profit margin
  arrange(rank_by_margin) %>%  # Order by rank (top margins first)
  filter(rank_by_margin<=3)     # Keep only top 3 states by profit margin
```
- 6.2) Highest revenue and profit (top 3).
```{r}
inner_join(orders, customer, by= "customer_id") %>%  # Join orders with customers by customer_id
      group_by(State) %>%      # Group data by State
      summarise(profit_state= sum(profit),  # Total profit per state
        revenue_state= sum(revenue),# Total revenue per state
        profit_margin= round( (profit_state/revenue_state)*100,2))%>% # Profit margin % per state
      arrange(desc(profit_state), desc(revenue_state)) %>% # Sort by highest profit, then revenue
      mutate(rank=row_number())%>% # Assign rank based on sorting
      filter(rank<=3)     # Keep top 3 states by profit
```
- 6.3) least profitable and least revenue
```{r}
inner_join(orders, customer, by="customer_id")%>% # Join orders and customers on customer_id
group_by(State) %>%                  # Group data by State
summarise(profit_state= sum(profit), # Sum of profit per state
  revenue_state= sum(revenue),       # Sum of revenue per state
  profit_margin= round( (profit_state/revenue_state)*100,2)) %>% # Profit margin % per state
arrange(profit_state, revenue_state)%>% #Sort by profit and revenue
mutate(rank= row_number()) %>%          # Assign rank based on sorted order
filter(rank<=3)                         # Keep only top 3 (lowest profit) states
```
- 6.4) Smaller states like Delaware and New Hampshire show high margins despite lower total revenue.
```{r}
inner_join(orders, customer, by="customer_id")%>% # Join orders with customer data on customer_id
group_by(State) %>%                               # Group data by State
summarise(profit_state= sum(profit),              # Sum profit for each state
  revenue_state= sum(revenue),                    # Sum revenue for each state
  profit_margin= round( (profit_state/revenue_state)*100,2)) %>%   # Calculate profit margin (%) per state
arrange( desc(profit_margin))                     # Sort states by profit margin, highest first
  
```
- Utah, Massachusetts, and New Mexico have the best profit efficiency.
- California, Texas, and Florida rank highest in both Revenue and Profit, but not in margin.
- Maine and Rhode Island are at the bottom in all three metrics: least profitable and least revenue.
- Smaller states like Delaware and New Hampshire show high margins despite lower total revenue.

### **7) Monthly profit trends and month-over-month comparisons.**
I first create a new column called Month_trend by extracting the month number from the New_date column. Then, I replace those numeric month values with their full month names using recode(). This way, my Month_trend column is easier to understand because it shows names like "January" instead of just numbers.

```{r}
orders<-orders %>% 
      mutate(Month_trend= month(New_date))



Monthly_Trend<-orders  %>%
          mutate(Month_trend=recode(Month_trend, "1"="January",
                                                 "2"="February",
                                                 "3"="March",
                                                 "4"="April",
                                                 "5"="May",
                                                 "6"="June",
                                                 "7"="July",
                                                 "8"="August",
                                                 "9"="September",
                                                 "10"="October",
                                                 "11"="November",
                                                 "12"="December"),
              Month_trend=factor(Month_trend,
                                 levels = c("January", "February", "March", "April",                                                             "May", "June", "July", "August",                                                                      "September", "October", "November",                                                                  "December"))) %>%
          group_by(Month_trend) %>% 
          summarise(Monthly_Profit= sum(profit))

Monthly_Trend

ggplot(Monthly_Trend, aes(x = Month_trend, y = Monthly_Profit)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  geom_line(aes(group = 1), color = "yellow", size = 1.2) +
  geom_point(color = "blue", size = 3) +
  theme_dark()  +
    theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title = element_text(hjust = 0.5)  
  ) +
  labs(
    title="Monthly Profit Trends",
    x= "Month",
    y="Profit"
  )


```

- June has the highest profit ($42,802.26), indicating a peak in sales or business activity mid-year.

- April ($41,131.00) and May ($38,847.24) also show strong profits, suggesting a strong spring season.

- January ($14,013.52) and February ($11,244.50) have relatively low profits, possibly due to post-holiday slowdowns or seasonal effects.

- November has the lowest profit ($9,760.52), which might be surprising since it’s close to the holiday season; this could suggest inventory issues, lower sales, or external factors affecting business.

- Profit fluctuates noticeably month-to-month, with some sharp increases from March to April and decreases after July.

- Summer months (June and July) show solid performance, but July’s profit ($31,550.40) dips compared to June, maybe reflecting some mid-summer slowdowns.

- October and September are on the lower side ($13,895.44 and $17,992.00 respectively), which might indicate seasonal variation or operational challenges.

- December ($16,567.86) rebounds from November’s low, possibly due to holiday shopping but doesn’t reach spring/summer highs.

- Overall, the data suggests strong seasonality, with peak sales in late spring and early summer, and dips in late fall and early year.

### **8) Monthly Revenue trends and month-over-month comparisons.**
```{r}

Revenue_Trend<-orders %>% mutate(Month_trend =recode( Month_trend,  "1"="January",
                                                 "2"="February",
                                                 "3"="March",
                                                 "4"="April",
                                                 "5"="May",
                                                 "6"="June",
                                                 "7"="July",
                                                 "8"="August",
                                                 "9"="September",
                                                 "10"="October",
                                                 "11"="November",
                                                 "12"="December"),
                Month_trend=factor(Month_trend, levels= c("January", "February", "March",
                                                          "April", "May","June", "July",
                                     "August","September","October","November","December"))) %>%
                  group_by(Month_trend) %>% 
                  summarise(Revenue= sum(revenue))

Revenue_Trend


ggplot(Revenue_Trend, aes(x=Month_trend,y=Revenue))+
      geom_bar(stat = "identity", fill="lightblue") +
      geom_line(aes(group=1), color="yellow", size=1.2) +
      geom_point(color= "blue", size=3) +theme_dark()+
      theme( axis.text.x = element_text(angle= 45, hjust=1),
             plot.title = element_text (hjust = 0.5))+
       labs( title= "Monthly Revenue Trend",
        x= " Month",
        y="Revenue")
  
   


```
- June had the highest revenue ($56,406.87), indicating peak business performance in early summer.

- April ($55,437.76) and May ($55,082.04) also showed strong revenue, suggesting a highly profitable spring season.

- July ($50,390.34) and August ($45,468.72) maintained solid performance, continuing the strong trend into summer.

- November recorded the lowest revenue ($17,088.32), which is unusually low considering seasonal events like Black Friday.

- December revenue ($23,869.79) improved from November but remained below the yearly average.

- January to March showed modest revenues ($27K–$35K), reflecting a slow start to the year.

- A sharp increase from March to April suggests seasonal growth or successful marketing campaigns.

- Revenue declined gradually from September ($33,366.54) to October ($27,995.24), showing post-summer slowdown.

- The data indicates a clear seasonal trend, with strong performance in late spring and early summer, followed by a steady decline into the last quarter of the year.

### **Executive Summary**

The business demonstrates strong profitability with an average profit margin of 62%, highlighting sports such as soccer and basketball for their volume and profit margins.

Customer ratings do not show a direct correlation with profitability; however, low ratings indicate potential areas for improvement.

Geographically, states like Utah and Massachusetts stand out for margin efficiency, while high-volume states such as California, Texas, and Florida dominate in total revenue and profit.

Seasonality is evident, with peaks in spring and summer (April to June) and notable declines in winter and fall, especially in November.

It is recommended to focus marketing campaigns during peak months and investigate the causes of low profitability in underperforming states and months.



